<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="..\..\styles.css">
    <link rel="stylesheet" href="..\..\styles_code.css">
    <title>SAP Astuces</title>
</head>

<header>
	<h1 class="header"><a href="..\..\index.html" class="blanc">Page Principale</a></h1>
</header>
	
<body>

    <h1 class="titre_secondaire">Astuce SAP - <a href="#transaction_sap" class="blanc">Transaction SAP</a> <a href="#API" class="blanc">API</a> </h1>
	
	<!-- ############################################################################################### -->
	<h2 class="first" id="transaction_sap">Transactions SAP</h2>
	<p class="section">
		<a href="transactions/generales.html">
			<mot_clef>Transactions üëÅ‚Äçüó®</mot_clef>
		</a>
		<br>
		<br>
		<info>Recueil de transaction SAP</info>
	</p>
	
	<!-- ############################################################################################### -->
	<h2 class="first">Donn√©es Utilisateur</h2>
	<p class="section">
	<mot_clef>PARAMETERS</mot_clef><br>
	<info>PARAMETERS permet √† l'utilisateur de rentrer une valeurs dans le champs</info><br>
	PARAMETERS v_variable TYPE table-champs.<br>
	<br>
	<info>Le mot clef 'DEFAULT' permet de pr√©remplir les donn√©es dans le champs</info><br>
	SELECT-OPTIONS: v_date FOR mara-ersda DEFAULT '20010101' TO '20011231'.<com> --> ici on viens d√©finit un ensemble de date</com>
	</p>
	
	<p class="section">
	<mot_clef>SELECT-OPTIONS</mot_clef><br>
	<info>Le SELECT-OPTIONS permet √† l'utilisateur de rentrer les valeurs et conditions qu'il souhaite</info><br>
	SELECT-OPTIONS: v_variable FOR table-champs.
	</p>
	
	<p class="section">
	<mot_clef>RADIO BUTTON</mot_clef><br>
	<info>Les RADIO BUTTON permettent √† l'utilisateur de selectionner une valeurs parmis un ensemble</info><br>
	PARAMETERS rb_01 RADIOBUTTON GROUP rb_0 DEFAULT 'X' USER-COMMAND ucomm. <com class="commentaire">" --> 'USER-COMMAND UCOMM' rend les Boutons Radio dynamiques au clique</com><br>
	PARAMETERS rb_02 RADIOBUTTON GROUP rb_0.
	<br>
	<br>
	<info>Les Bouttons Radio sont associ√© √† un groupe pour savoir √† qui ils sont li√©s.<br>
	Ils ont aussi un nom de variable pour d√©finir si leur √©tat est 'X' ou ' '.</info>
	</p>
	
	<!-- ############################################################################################### -->
	<h2 class="first">Affichage</h2>
	<p class="section">
	<mot_clef>Onglets</mot_clef><br>
	<info>Les Onglets permettent √† l'utilisateur de naviguer dans plusieurs pages de l'application</info><br>
	<br>
	<com>Initialisation des √©crants pour les onglets</com><br>
	SELECTION-SCREEN BEGIN OF SCREEN 100 AS SUBSCREEN.<br>
	SELECTION-SCREEN END OF SCREEN 100.<br>
	<br>
	SELECTION-SCREEN BEGIN OF SCREEN 200 AS SUBSCREEN.<br>
	SELECTION-SCREEN END OF SCREEN 200.<br>
	<br>
	SELECTION-SCREEN BEGIN OF SCREEN 300 AS SUBSCREEN.<br>
	SELECTION-SCREEN END OF SCREEN 300.<br>
	<br>
	<com>Cr√©ation des onglets dans un bloque</com><br>
	SELECTION-SCREEN: BEGIN OF TABBED BLOCK vb_onglets FOR 30 LINES,<br>
    TAB (20) tab0 USER-COMMAND ucomm_1 DEFAULT SCREEN 100,<br>
    TAB (20) tab1 USER-COMMAND ucomm_2 DEFAULT SCREEN 200,<br>
    TAB (20) tab2 USER-COMMAND ucomm_3 DEFAULT SCREEN 300,<br>
	END OF BLOCK vb_onglets.
	<br>
	<br>
	<info>Pour ajouter des √©l√©ments dans les onglets il faudra les mettres dans l'initialisation de l'√©crants voulus</info>
	</p>
	
	
	<p class="section">
	<mot_clef>Objet ALV</mot_clef><br>
	<info>L'affichage ALV est la version am√©lior√© du 'Write' :<br>
	- Il permet d'affiche sous forme de tableau des donn√©es<br>
	- Il peut aussi les trier et les organiser.</info>
	<br>
	<br>
	TRY.<br>
	  cl_salv_table=>factory( IMPORTING r_salv_table  = DATA(lo_alv)<br>
							  CHANGING  t_table       = lt_mara ). <com class="commentaire">" --> 't_table' est la table d'affichage du tableau ALV</com><br>
	<br>
	  lo_alv->get_functions( )->set_all( abap_true ).<br>
	<br>
	  DATA(lo_layout) = lo_alv->get_layout( ).<br>
	<br>
	  lo_layout->set_key( VALUE salv_s_layout_key( report = sy-repid ) ).<br>
	  lo_layout->set_default( abap_true ).<br>
	  lo_layout->set_save_restriction( if_salv_c_layout=>restrict_none ).<br>
	  lo_alv->display( ).<br>
	<br>
	  CATCH cx_salv_msg.<br>
	  CATCH cx_salv_not_found.<br>
	ENDTRY.
	</p>
	<!-- ############################################################################################### -->
	<h2 class="first">Requ√™tes</h2>
	<p class="section">
	<mot_clef>SELECT</mot_clef><br>
	<info>Les SELECT permettent de faire des requ√™tes dans une table pour en extraire des donn√©es</info>
	<br>
	<br>
	<br>
	TABLES: mara.<br>
	<br>
	<com>"D√©claration du type --> Permet de cr√©er un type de table avec diff√©rents champs</com><br>
	TYPES: BEGIN OF ty_mara,<br>
			 nom  TYPE aenam,<br>
			 date TYPE ersda,<br>
		   END OF ty_mara.<br>
	<br>
	<com>" D√©claration d'une ent√™te du type de table [ls_mara] et de la variable de la table [lt_mara].</com><br>
	DATA: lt_mara TYPE TABLE OF ty_mara,<br>
		  ls_mara TYPE ty_mara.<br>
	<br>
	<com>"Permet √† l'utilisateur de rentrer les valeurs et conditions qu'il souhaite</com><br>
	SELECT-OPTIONS: v_date FOR mara-ersda.<br>
	SELECT-OPTIONS: v_nom  FOR mara-aenam.<br>
	<br>
	<com>" Requ√™te des champs de la table</com><br>
	SELECT FROM mara <br>
	  FIELDS aenam, ersda <br>
	  WHERE ersda IN @v_date "AAAAMMJJ<br>
          AND   aenam IN @v_nom <br>
	  INTO TABLE @lt_mara. <br>
	<br>
	<com>"R√©cup√©ration des donn√©es de la requ√™te</com><br>
	LOOP AT lt_mara INTO ls_mara.<br>
	  WRITE: / ls_mara-nom, '--', ls_mara-date.<br>
	ENDLOOP.
	</p>
	
	
	
	<p class="section">
	<mot_clef>SELECT INNER JOIN --> Potentiellement Obsolette (Voir syntaxe SELECT)</mot_clef><br>
	<info>Les SELECT INNER JOIN permettent de faire des requ√™tes dans plusieurs table pour en extraire des donn√©es avec un param√®tre commun</info>
	<br>
	<br>
	<br>
	TABLES: mara, bkpf.<br>
	<br>
	SELECT a~aenam,<br>
       a~ersda,<br>
       b~bukrs<br>
    INTO TABLE @lt_table<br>
    FROM mara AS a<br>
    INNER JOIN bkpf AS b <com>" --> les champs 'ersda' de la table 'mara' et 'bldat' de la table 'bkpf' contiennent des valeurs √©quivalentes, ce qui √©tablit une relation entre les deux tables</com><br>
    ON a~ersda = b~bldat<br>
    WHERE a~ersda In @v_date<br>
		AND a~aenam In @v_nom.<br>
	</p>



	<p class="section">
	<mot_clef>SORT</mot_clef><br>
	<info>SORT permet de trier une table interne par rapport √† une colonne.</info><br>
	<br>
	<com>" Trier la table par date</com><br>
	SORT lt_mara by date.
	<br>
	</p>

	
	<p class="section">
	<mot_clef>AT</mot_clef><br>
	<info>Les AT sont des conditions qui permettent de passer dans le code √† chaque changement de donn√©e de la colonne choisie ou d'une colonne qui la pr√©c√®des.</info><br>
	<br>
	TABLES: mara.<br>
	<br>
	<com>"D√©claration du type --> Permet de cr√©er un type de table avec diff√©rents champs</com><br>
	TYPES: BEGIN OF ty_mara,<br>
	         date    TYPE ersda,<br>
	         nom     TYPE aenam,<br>
	         matiere TYPE wrkst,<br>
	       END OF ty_mara.<br>
	<br>
	<com>" D√©claration d'une ent√™te du type de table [ls_mara] et de la variable de la table [lt_mara].</com><br>
	DATA: lt_mara TYPE TABLE OF ty_mara,<br>
	      ls_mara TYPE ty_mara.<br>
	<br>
	<com>"Permet √† l'utilisateur de rentrer les valeurs et conditions qu'il souhaite</com><br>
	SELECT-OPTIONS: v_date FOR mara-ersda.<br>
	SELECT-OPTIONS: v_nom FOR mara-aenam.<br>
	<br>
	<com>" Requ√™te des champs de la table</com><br>
	SELECT FROM mara <br>
	  FIELDS aenam, ersda <br>
	  WHERE ersda IN @v_date "AAAAMMJJ<br>
          AND   aenam IN @v_nom <br>
	  INTO TABLE @lt_mara. <br>
	<br>
	LOOP AT lt_mara ASSIGNING FIELD-SYMBOL(<ls_mara>). <com>" --> faire un field symbole</com><br>
	<br>
	<com>Ecrit d√®s qu'une date change (ou une de ses colonnes pr√©c√©dentes)</com><br>
	AT NEW date.<br>
    	WRITE: /, <ls_mara>-nom, '--', <ls_mara>-date, '--', <ls_mara>-matiere.<br>
  	ENDAT.<br>
	<br>
	<com>Ecrit quand un groupe de date arrive va changer (ou une de ses colonnes pr√©c√©dentes)</com><br>
	AT END OF date.<br>
    	WRITE: /, '------------------', /.<br>
  	ENDAT.<br>
	ENDLOOP.<br>
	<br>
	</p>
	
	<!-- ############################################################################################### -->
	<h2 class="first">Variables</h2>
	<p class="section">
	<mot_clef>DATA [TYPE]</mot_clef><br>
	<info>L'instruction 'DATA' permet de faire des variables qui stocks des donn√©es</info>
	<br>
	<br>
	DATA: variable_1 TYPE i,<br>
		  variable_2 TYPE i,<br>
		  variable_3 TYPE i.
	</p>
	
	<p class="section">
	<mot_clef>DATA [TYPE REF TO]</mot_clef><br>
	<info>
		L'instruction 'TYPE REF TO' permet de faire des pointeurs qui stock la case m√©moire d'une variable.<br>
		Elle va de paire avec l'instruction 'GET REFERENCE OF' qui permet de renseigner la case m√©moir d'une variable.
	</info>
	<br>
	<br>
	DATA: lo_variable_1 TYPE REF TO i.<br>
	DATA: lo_variable_2 TYPE REF TO i.<br>
	DATA: lo_variable_3 TYPE REF TO i.<br>
	<br>
	<com>
	" Asignation des emplacement des variables<br>
	</com>
	GET REFERENCE OF variable_1 INTO lo_variable_1.<br>
	GET REFERENCE OF variable_2 INTO lo_variable_2.<br>
	GET REFERENCE OF variable_3 INTO lo_variable_3.<br>
	<br>
	<br>
	<info>Pour r√©cuperer la valeur de la variable nous pouvons faire comme ceci :</info><br>
	<br>
	x = variable_1.
	<br>
	<br>
	<info>Ou bien comme ceci :</info><br>
	<br>
	x = lo_variable_1->*.<br>
	<br>
	<br>
	<info>Il est √©galement possible de changer le chemin d'un pointeur :</info><br>
	<br>
	lo_variable_1->* = lo_variable_2->*.<br>
	<br>
	<br>
	--------------------------------------------------------------------------------------------------------<br>
	<br>
	<info>Voici un programme d'exemple r√©unissant les notions vue ci-dessus :</info>
	<br>
	<br>
	<com>
	* ###############################################<br>
	* D√©claration des variables<br>
	* ###############################################<br>
	</com>
	DATA: variable_1 TYPE i,<br>
		  variable_2 TYPE i,<br>
		  variable_3 TYPE i,<br>
		  increment  TYPE i.<br>
	<br>
	DATA: it_table TYPE TABLE OF REF TO i."data.<br>
	<br>
	DATA: lo_variable_1 TYPE REF TO i.<br>
	DATA: lo_variable_2 TYPE REF TO i.<br>
	DATA: lo_variable_3 TYPE REF TO i.<br>
	<br>
	<com>
	* ###############################################<br>
	* Asignation des emplacements de variables<br>
	* ###############################################<br>
	</com>
	GET REFERENCE OF variable_1 INTO lo_variable_1.<br>
	GET REFERENCE OF variable_2 INTO lo_variable_2.<br>
	GET REFERENCE OF variable_3 INTO lo_variable_3.<br>
	<br>
	variable_1 = 1.<br>
	variable_2 = 2.<br>
	variable_3 = 3.<br>
	<br>
	<com>" enregistrement de la valeur du chemin de la variable</com><br>
	APPEND lo_variable_1 TO it_table.<br>
	APPEND lo_variable_2 TO it_table.<br>
	APPEND lo_variable_3 TO it_table.<br>
	<br>
	<com>
	* ###############################################<br>
	* Code principale<br>
	* ###############################################<br>
	</com>
	PERFORM afficher.<br>
	<br>
	<com>" traitement sur chemin variable</com><br>
	lo_variable_1->* = lo_variable_2->*.<br>
	<br>
	PERFORM afficher.<br>
	<br>
	<com>" traitement sur chemin variable dans une table</com><br>
	increment = 1.<br>
	DO 2 TIMES.<br>
	  TRY.<br>
		  lo_variable_1 = it_table[ increment ].  <com>" red√©finis le chemin d'acc√®s de la variable</com><br>
		  lo_variable_1->* = lo_variable_3->*.    <com>" modifie la valeur de la variable par son chemin d'acc√®s</com><br>
		<br>
		CATCH cx_sy_itab_line_not_found.<br>
		  WRITE 'erreur'.<br>
	  ENDTRY.<br>
	<br>
	  increment = increment + 1.<br>
	ENDDO.<br>
	<br>
	PERFORM afficher.<br>
	<br>
	<com>* ########################################################################################</com><br>
	FORM afficher.<br>
	  WRITE: / |variable_1 = { variable_1 }|,<br>
			 / |variable_2 = { variable_2 }|,<br>
			 / |variable_3 = { variable_3 }|,<br>
			 / '‚Äé'.<br>
	ENDFORM.<br>
	<br>
	<info>Sortie du programme :</info>
	<br>
	<br>
	variable_1 = 1<br>
	variable_2 = 2<br>
	variable_3 = 3<br>
	<br>
	variable_1 = 2<br>
	variable_2 = 2<br>
	variable_3 = 3<br>
	<br>
	variable_1 = 3<br>
	variable_2 = 3<br>
	variable_3 = 3<br>
	</p>
	
	<!-- _-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_ -->
	<p class="section">
	<mot_clef>Concat√©nation</mot_clef><br>
	<info>La concat√©nation permet d'assembler des donn√©es (texte / nombre) pour en faire une seul donn√©e texte.</info>
	<br>
	<br>
	DATA:<br>
      variable_final(70)  TYPE c,<br>
      v_date(20)          TYPE c,<br>
      v_nom(20)           TYPE c,<br>
      v_age               TYPE i.<br>
	<br>
	variable_final = space. <com>" 'SPACE' fais que le champs est vide, pareille pour ''</com><br>
	v_date = '31 Janvier 2024'.<br>
	v_nom  = 'Jo√´l'.<br>
	v_age  = '22'.<br>
	<br>
	<com>" Concat√©nation</com><br>
	variable_final = |Le { v_date } { v_nom } √† { v_age } ans.|. <com>" Bien mettre les espaces au d√©but et √† la fin des accolades</com><br>
	<br>
	WRITE variable_final.<br>
	</p>


	<p class="section">
	<mot_clef>Modifier Une table</mot_clef><br>
	<info>Les modifications de tables permettent de modifier les donn√©es dans une table.</info><br>
	<br>
	<mot_clef> /!\ /!\ /!\ ON NE CHANGE QUE LES TABLES INTERNES /!\ /!\ /!\ </mot_clef><br>
	<br>
	<com>M√©thode 1</com><br>
	LOOP AT lt_mara INTO ls_mara.<br>
	ls_mara-nom = ''.<br>
	MODIFY lt_mara FROM ls_mara TRANSPORTING nom.<br>
	ENDLOOP.<br>
	<br>
	<br>
	<com>M√©thode 2</com><br>
	ls_mara-nom = ''.<br>
	MODIFY lt_mara FROM ls_mara TRANSPORTING nom WHERE nom IS NOT INITIAL.<br>
	<br>
	<br>
	<com>M√©thode 3</com><br>
	LOOP AT lt_mara ASSIGNING FIELD-SYMBOL(<ls_mara>). <com>D√©claration du FIELD-SYMBOL √† la vol√©e.</com><br>
  	<ls_mara>-nom = ''.<br>
	ENDLOOP.
	</p>


	<!-- _-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_ -->
	<p class="section">
	<mot_clef>FIELD-SYMBOLS</mot_clef><br>
	<info>Le FIELD-SYMBOLS permet d'avoir une variable avec un type dyamique (texte / nombre / structure / ...).</info>
	<br>
	<br>
	DATA: w_name  TYPE string VALUE `Valeur 1`,<br>
	w_index TYPE i      VALUE 1.<br>
	<br>
	FIELD-SYMBOLS &lt;fs_test&gt; TYPE any. <com>" D√©claration pour tout les types standards</com><br>
	<br>
	ASSIGN w_name TO &lt;fs_test&gt;.       <com>" Assigne le type de "w_name" au "FIELD-SYMBOLS"</com><br>
	PERFORM afficher.<br>
	<br>
	&lt;fs_test&gt; = 'Valeur 2'.           <com>" Changes la valeur de &lt;fs_test&gt;</com><br>
	PERFORM afficher.<br>
	<br>
	ASSIGN w_index TO &lt;fs_test&gt;.      <com>" R√©assigne un nouveau type √† &lt;fs_test&gt;, il est maintenant de type "i"</com><br>
	PERFORM afficher.<br>
	<br>
	ADD 1 TO &lt;fs_test&gt;.               <com>" Incr√©mente la valeur de &lt;fs_test&gt;</com><br>
	PERFORM afficher.<br>
	<br>
	<br>
	<br>
	FORM afficher.<br>
	  WRITE: &lt;fs_test&gt;, /.<br>
	ENDFORM.
		
	<!-- ############################################################################################### -->
	<h2 class="first" id="API">API</h2>
	<p class="section">
		<a href="api/costcenter.html" id="API">
			<mot_clef>ZAPI_COSTCENTER_SRV üëÅ‚Äçüó®</mot_clef>
		</a>
		<br>
		<br>
		<info>API SAP sur les COSTCENTER</info>
	</p>
</body>
</html>
